=Intro=
This is API for [[CudaText]] in Python. 

* Main Py module is cudatext. Main module has constants, funcs, class Editor, objects of class Editor.
* Additional module: cudatext_cmd has constants for command runner func.

=Global funcs=

===app_version===

 app_version()

Gets version of program (str).

===app_api_version===

 app_api_version()

Gets version of API (str).

String contains 3 numbers, dot-separated.

===app_path===

 app_path(id)

Gets some path. Possible values of id:

* APP_DIR_EXE: Dir of program executable.
* APP_DIR_SETTINGS: Dir "settings".
* APP_DIR_DATA: Dir "data".
* APP_DIR_PY: Dir with Python data "py".

===msg_box===

 msg_box(text, flags)

Shows modal message-box with given text.

Param flags is sum of button-value (OK, OK/Cancel, Yes/No etc) and icon-value (Info, Warning, Error, Question):

* MB_OK
* MB_OKCANCEL
* MB_ABORTRETRYIGNORE
* MB_YESNOCANCEL
* MB_YESNO
* MB_RETRYCANCEL

* MB_ICONERROR
* MB_ICONQUESTION
* MB_ICONWARNING
* MB_ICONINFO

Gets int code of button pressed:

* ID_OK
* ID_CANCEL
* ID_ABORT
* ID_RETRY
* ID_IGNORE
* ID_YES
* ID_NO

===msg_status===

 msg_status(text)

Shows given text in statusbar field.

===dlg_input===

 dlg_input(label, defvalue)

Shows modal dialog to input one string.

Gets entered string or None of cancelled.

===dlg_input_ex===

 dlg_input_ex(number, caption,
               label1   , text1="", label2="", text2="", label3="", text3="",
               label4="", text4="", label5="", text5="", label6="", text6="",
               label7="", text7="", label8="", text8="", label9="", text9="",
               label10="", text10="")

Shows modal dialog to enter 1 to 10 strings. Param number is count of strings.

Gets list of entered strings or None if cancelled.

===dlg_file===

 dlg_file(is_open, init_filename, init_dir, filters)

Shows file-open or file-save-as modal dialog.

Gets filename (str) or None if cancelled. Params:

* is_open: True for open dialog, False for save-as dialog.
* init_filename: Initial filename for save-as dialog. Can be empty.
* init_dir: Initial dir for dialog. Can be empty.
* filters: Sets file filters for dialog. Can be empty. Example, 2 filters: "Texts|*.pas;*.txt|Include|*.inc"

To allow multi-select in open dialog, pass init_filename="*". If single filename selected, result is str. If several filenames selected, result is list of str.

===dlg_menu===

 dlg_menu(id, text)

Shows modal menu. 
Gets index of item selected (0-base), or None of cancelled.

Possible values of id:

* MENU_LIST: Dialog with listbox similar to Commands dialog of CudaText, with filter field.
* MENU_LIST_ALT: Like MENU_LIST but each item has 2x height, and instead of right-aligning, part of an item shows below.

Param text is string items, separated by "\n" char. Each item can be simple str or str1+"\t"+str2 (str2 shows right-aligned or below).

===file_open===

 file_open(filename)

Opens editor tab with given filename. If filename already opened, activates its tab. Pass empty str to open untitled tab.

===file_save===

 file_save()

Saves current tab to disk. Shows save-as dialog for untitled tab.

===ed_handles===

 ed_handles()

Gets range object: it contains int handles of all editor tabs. Pass each handle to Editor() to make editor object from handle.

Example command in console, prints filenames of all tabs:

<syntaxhighlight>
for h in ed_handles(): print(Editor(h).get_filename())
</syntaxhighlight>

===ini_read/ini_write===

 ini_read(filename, section, key, value)
 ini_write(filename, section, key, value)

Reads or writes single string to ini file. Params:

* filename: Full path of ini file. Can be name w/o path, this means that path of "settings" dir is used.
* section: str: Section of ini file.
* key: str: Key in section.
* value: On write: value to write. On read: default value which is returned if no such filename/section/key is found.

Gets string which is read, gets None on write.

=Editor class=

Editor class has methods to work with editor. Global objects of Editor exist:

* ed: refers to currently focused editor (for any tab)
* ed_bro: refers to "brother" of ed. If tab is splitted, 2 editors are shown: 1st/2nd. 1st and 2nd are "brother" editors.

==Carets==
===get_carets===

 get_carets()

Returns list of 4-tuples, each item is info about one caret: (PosX, PosY, EndX, EndY).

* PosX is column (0-base). Tab-chars give x increment 1, like others.
* PosY is line (0-base).
* EndX/EndY is position of selection end for this caret or both -1 if no selection.

===set_caret===

 set_caret(posx, posy, endx=-1, endy=-1)

Sets single caret (4 ints, see above). Multi-carets are removed.

===add_caret===

 add_caret(posx, posy, endx=-1, endy=-1)

Adds one caret (4 ints, see above).

Removes all carets, if called with posx<0. Text editing not possible w/o carets, so you must add caret then.

==Text read/write==

===get_text_all/set_text_all===

 get_text_all()
 set_text_all(text)

Gets/sets entire text in the editor (str).

===get_text_line/set_text_line===

 get_text_line(num)
 set_text_line(num, text)

Gets/sets single line (str) with given index (0-base).

Line must be w/o CR LF. Gets None if index incorrect.

To add new line, call set with num=-1.

===get_text_substr===

 get_text_substr(x1, y1, x2, y2)

Gets substring from position (x1, y1) to position (x2, y2). Second position must be bigger than first.

===delete===

 delete(x1, y1, x2, y2)

Deletes range from position (x1, y1) to bigger position (x2, y2). (Too big x1/x2 are allowed).

Note: don't pass tuple from get_carets()[0], this tuple has not sorted pos=(x1, y1), end=(x2, y2), you need to sort them (first sort by y, then by x).

===insert===

 insert(x, y, text)

Inserts given text at position (x, y), text can be multi-line with CR and/or LF.

Gets 2-tuple (x, y) of position after inserted text. It is on the same line, if text is single line.

==Selection==

===get_text_sel===

 get_text_sel()

Returns selected text for 1st caret (empty, if no selection).

===get_sel_mode===

 get_sel_mode()

Gets kind of selection: normal or column selection: SEL_NORMAL, SEL_COLUMN.

===get_sel_lines===

 get_sel_lines()

Gets 2-tuple, indexes of 1st and last lines affected by 1st caret selection. Both -1 if no selection.

===get_sel_rect/set_sel_rect===

 get_sel_rect()
 set_sel_rect(x1, y1, x2, y2)

Gets/sets coords of column selection.

Gets 4-tuple (x1, y1, x2, y2). All 0 if no column selection.

==Properties==

===get_line_count===

 get_line_count()

Gets number of lines.

===get_line_prop===

 get_line_prop(num)

Gets properties if line with given index (0-base), 2-tuple. 

* 1st value: length of line. 
* 2nd: line state, one if values LINESTATE_nnn. Line state changes from "normal" to "changed" if line modifies, set to "new" for inserted lines, set from "changed/new" to "saved" after file is saved.

Gets None for incorrect index.

===get_filename===

 get_filename()

Gets str: filename for the editor. Empty if tab is untitled.

===get_tabcolor/set_tabcolor===

 get_tabcolor()
 set_tabcolor(value)

Gets/sets custom color (int) of tab for the editor. It's COLOR_NONE if color is not set.

===get_enc/set_enc===

 get_enc()
 set_enc(value)

Gets/sets encoding name for the editor. It's one of the strings which are visible in the encodings menu of statusbar: "UTF-8", "ANSI" etc.

===get_top/set_top===

 get_top()
 set_top(value)

Gets/sets index of top visible line in editor.

===get_split/set_split===

 get_split()
 set_split(state, percent)

Gets/sets tab splitting: each tab can be splitted to primary/second editors.

Gets 2-tuple:

* int: state of splitting, one of the values
** TAB_SPLIT_NO: tab not splitted
** TAB_SPLIT_HORZ
** TAB_SPLIT_VERT 
* float: percent of splitting, it's 0.5 if tab splitted 50/50.

===bookmark===

 bookmark(id, nline, nkind=1, ncolor=-1, icon="")

Controls bookmarks. Possible values of id:

* BOOKMARK_GET: Gets kind of bookmark at line=nline. 0 means no bookmark, 1 means usual bookmark.
* BOOKMARK_SET: Sets bookmark with kind=nkind at line=nline. 1 means usual bookmark with usual color and icon. Other kind values mean custom bookmark, which must be setup via BOOKMARK_SETUP.
* BOOKMARK_CLEAR: Removes bookmark from line=nline (nkind ignored).
* BOOKMARK_CLEAR_ALL: Removes all bookmarks (nline, nkind ignored).
* BOOKMARK_SETUP: Setup custom bookmarks with kind=nkind (nline ignored). Setup is:
** ncolor: color of bookmarked line. Can be COLOR_NONE to not show bg-color.
** icon: path to icon file for gutter, .bmp file of size 16x16.
* BOOKMARK_GET_LIST: Gets list of line indexes with bookmarks (nline, nkind ignored).

Notes:

* nkind must be 1..255.
* nkind values 240..249 have setup by default: they have blue icons "0" to "9".

==Misc==

===cmd===

 cmd(code)

Command runner, it runs any command of editor by its int code. See codes in module cudatext_cmd.

===focus===

 focus()

Activates editor's tab and focuses editor itself. It's needed when you want to activate inactive tab.

===lock/unlock===

 lock()
 unlock()

These lock, then unlock editor. Locked editor is not painted and shows text label "Wait...".

===complete===

 complete(text, len1, len2)

Shows auto-completion listbox with given items.

* text: string with items, must be formatted as shown in the [[ATSynEdit#Auto-completion_lists]].
* len1: count of chars to the left of the caret, to be replaced.
* len2: count of chars to the right of the caret, to be replaced.

Note: listbox disappears if you move caret or type text, unlike usual auto-completion listboxes (they can recalculate items for new caret pos).
